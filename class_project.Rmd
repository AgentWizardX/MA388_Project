---
title: "Class Project"
author: "Sorie Yillah"
date: "4/6/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Imports go here
library(tidyverse)
library(Lahman)
library(lubridate)
library(baseballr)
library(mgcv)
library(lme4)
library(broom)
library(modelr)
```

```{r}
start_dates <- seq(ymd("2016-04-03"), ymd("2016-09-30"), by = "10 days")
end_dates <- start_dates + 9

hit_into_play2016 <- map2_dfr(start_dates, end_dates, scrape_statcast_savant) %>% 
  filter(description == "hit_into_play") %>% 
  filter(launch_speed < 150,
         launch_speed > 0,
         launch_angle < 360)

model.location = gam(events == "home_run" ~ s(plate_x, plate_z),
                     family = "binomial",
                     data = hit_into_play2016)

summary(model.location)

  
#fit random effects model adjusting for pitch location
hit_into_play2016 = model.location %>%
  augment(tpe.predict = "response",
          newdata = hit_into_play2016) %>%
  rename(HR_prob = .fitted)

model_random_effects = glmer(events == "home_run" ~ HR_prob + (1|batter),
                             family = "binomial",
                             data = hit_into_play2016)   #one with vertical line indicated random effect
summary(model_random_effects)

```
